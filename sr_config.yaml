# ============================================================================
# PIVOT DETECTION PARAMETERS
# ============================================================================
pivot_detection:
  # Lookback windows
  lookback:
    # Per-timeframe defaults
    defaults:
      "5m": {n1: 8, n2: 5}
      "15m": {n1: 8, n2: 6}
      "30m": {n1: 8, n2: 6}
      "1h": {n1: 10, n2: 6}
      "4h": {n1: 10, n2: 8}
      "1d": {n1: 12, n2: 8}
      "1w": {n1: 15, n2: 10}
  
  # Historical depth (bars to analyze)
  historical_depth:
    "5m": 200
    "15m": 300
    "30m": 250
    "1h": 200
    "4h": 150
    "1d": 100
    "1w": 50
  
  # Price smoothing (reduce noise)
  smoothing:
    enabled: true
    period: 3

# ============================================================================
# ZONE FORMATION PARAMETERS
# ============================================================================
zone_formation:
  # ATR-based zone width
  atr:
    period: 14
  
  # Zone width multipliers
  width_multiplier:
    default: 0.8
  
  # Clustering
  clustering:
    tolerance_multiplier: 1.5  # Extends zone_width for grouping
  
  # Volume weighting
  volume_weighted_center: true
  
  # Minimum touches to validate
  min_touch_count: 2

# ============================================================================
# VALIDATION PARAMETERS
# ============================================================================
validation:
  # Wick rejection criteria
  wick_rejection:
    enabled: true
    wick_to_body_ratio: 1.0
    min_rejection_ratio: 0.4  # % of touches showing rejection
  
  # Volume confirmation
  volume_confirmation:
    volume_lookback: 20  # bars for average
    breakout_volume_multiplier: 1.5
  
  # Strength filtering
  strength:
    min_threshold: 2.5

# ============================================================================
# MULTI-TIMEFRAME CONFLUENCE
# ============================================================================
confluence:
  # Base timeframe weights
  timeframe_weights:
    "1w": 6.0
    "1d": 5.0
    "4h": 4.0
    "1h": 3.0
    "30m": 2.5
    "15m": 2.0
    "5m": 1.0
    "1m": 0.5
  
  # Age decay
  age_decay:
    lambda: 0.003
    max_age_bars: 1000
  
  # Inactivity penalty
  inactivity_penalty:
    enabled: true
    threshold_bars: 300  # No touch in X bars
    decay_rate: 0.8  # Exponential decay factor
  
  # Touch bonuses
  touch_bonus:
    multiplier: 0.3  # Per additional touch

# ============================================================================
# DYNAMIC UPDATES
# ============================================================================
dynamic_updates:
  # Breakout handling
  breakout:
    flip_support_resistance: true
